USE AIGI_EDR_COMMONMODEL.UTILITY;

DELETE FROM MDD_DYNAMIC_QUERIES WHERE ID=2;

-- liquibase formatted sql
-- changeset ALT_MKT_0.1:ADD1CLASS1STAT1CD-1

-- changeset LEN_0.1:ADD1MRKT1REGN-1

-- changeset SUR_0.1:ADD1POL1SYM1CD-1
insert into MDD_DYNAMIC_QUERIES
(ID, QUERY_ID, TGT_TBL_DB, TGT_TBL_SCHEMA, TGT_TBL, TARGET_TBL, TARGET_TYPE, HASH_KEY_NAME, FINAL_QUERY, TGT_COL_LIST, DELETE_LOGIC_DRVNG_TBL_ID, DEL_TBL_NAME, DEL_TBL_ALIAS, DEL_TBL_FULL_NAME, IS_SOURCE_VAULT_TBL, DEL_STREAM_TBL, DEL_STREAM_TBL_HIST)
VALUES
(2,	2,	'AIGI_EDR_COMMONMODEL',	'COMMON',	'RAW_CAD',	'POC.MGA_PROGRAM.RAW_CAD',	'RAW_CAD Target table','',
$$SELECT LNDNG_SRC_TBL_CD.INTERNAL_ID as INTERNAL_ID,
LNDNG_SRC_TBL_CD.EXTERNAL_ID as EXTERNAL_ID,
LNDNG_SRC_TBL_CD.INSURED_NAME as INSURED_NAME,
LNDNG_SRC_TBL_CD.POLICY_TYPE as POLICY_TYPE,
LNDNG_SRC_TBL_CD.POLICY_NUMBER as POLICY_NUMBER,
LNDNG_SRC_TBL_CD.MODULE as MODULE,
LNDNG_SRC_TBL_CD.FULL_POLICY as FULL_POLICY,
LNDNG_SRC_TBL_CD.COALITION_POLICY_NUMBER as COALITION_POLICY_NUMBER,
LNDNG_SRC_TBL_CD.POLICY_EFFECTIVE_DATE as POLICY_EFFECTIVE_DATE,
LNDNG_SRC_TBL_CD.POLICY_EXPIRATION_DATE as POLICY_EXPIRATION_DATE,
LNDNG_SRC_TBL_CD.TRANSACTION_EFFECTIVE_DATE as TRANSACTION_EFFECTIVE_DATE,
LNDNG_SRC_TBL_CD.TRANSACTION_TYPE as TRANSACTION_TYPE,
LNDNG_SRC_TBL_CD.TRANSACTION_DESCRIPTION as TRANSACTION_DESCRIPTION,
LNDNG_SRC_TBL_CD.TRANSACTION_EFFECTIVE_BIND_DATE as TRANSACTION_EFFECTIVE_BIND_DATE,
LNDNG_SRC_TBL_CD.AGGREGATE_TOTAL_LIMIT as AGGREGATE_TOTAL_LIMIT,
LNDNG_SRC_TBL_CD.TOTAL_LIMIT as TOTAL_LIMIT,
LNDNG_SRC_TBL_CD.ARCH_QUOTA_SHARE as ARCH_QUOTA_SHARE,
LNDNG_SRC_TBL_CD.ARCH_LIMIT_OF_LIABILITY as ARCH_LIMIT_OF_LIABILITY,
LNDNG_SRC_TBL_CD.SIR_ATTACHMENT_POINT as SIR_ATTACHMENT_POINT,
LNDNG_SRC_TBL_CD.TOTAL_BOUND_PREMIUM as TOTAL_BOUND_PREMIUM,
LNDNG_SRC_TBL_CD.ARCH_BOUND_PREMIUM as ARCH_BOUND_PREMIUM,
LNDNG_SRC_TBL_CD.TOTAL_EARNED_PREMIUM as TOTAL_EARNED_PREMIUM,
LNDNG_SRC_TBL_CD.TOTAL_UNEARNED_PREMIUM as TOTAL_UNEARNED_PREMIUM,
LNDNG_SRC_TBL_CD.COALITION_COMMISSION as COALITION_COMMISSION,
LNDNG_SRC_TBL_CD.ARCH_COMMISSION_TO_COALITION as ARCH_COMMISSION_TO_COALITION,
LNDNG_SRC_TBL_CD.ARCH_NET_PREMIUM as ARCH_NET_PREMIUM,
LNDNG_SRC_TBL_CD.TOTAL_TRIA as TOTAL_TRIA,
LNDNG_SRC_TBL_CD.ARCH_TRIA as ARCH_TRIA,
LNDNG_SRC_TBL_CD.TRIA_ACCEPTED as TRIA_ACCEPTED,
LNDNG_SRC_TBL_CD.BROKER as BROKER,
LNDNG_SRC_TBL_CD.BROKER_ADDRESS as BROKER_ADDRESS,
LNDNG_SRC_TBL_CD.BROKER_CITY as BROKER_CITY,
LNDNG_SRC_TBL_CD.BROKER_STATE as BROKER_STATE,
LNDNG_SRC_TBL_CD.BROKER_ZIP_CODE as BROKER_ZIP_CODE,
LNDNG_SRC_TBL_CD.BROKER_COMMISSION as BROKER_COMMISSION,
LNDNG_SRC_TBL_CD.BROKER_REPORTED_LICENSE_NUMBER as BROKER_REPORTED_LICENSE_NUMBER,
LNDNG_SRC_TBL_CD.REPORTED_LICENSE_ENTITY_INDIVIDUAL as REPORTED_LICENSE_ENTITY_INDIVIDUAL,
LNDNG_SRC_TBL_CD.COALITION_SECONDARY_REVIEW as COALITION_SECONDARY_REVIEW,
LNDNG_SRC_TBL_CD.CARRIER_REFERRAL as CARRIER_REFERRAL,
LNDNG_SRC_TBL_CD.ACCOUNT_CURRENT_MONTH_END as ACCOUNT_CURRENT_MONTH_END,
LNDNG_SRC_TBL_CD.CURRENT_MONTH_END as CURRENT_MONTH_END,
LNDNG_SRC_TBL_CD.POLICY_STATUS_INDICATOR as POLICY_STATUS_INDICATOR,
LNDNG_SRC_TBL_CD.COMMENTS as COMMENTS,
LNDNG_SRC_TBL_CD.INSURED_ADDRESS_LINE_1 as INSURED_ADDRESS_LINE_1,
LNDNG_SRC_TBL_CD.INSURED_ADDRESS_LINE_2 as INSURED_ADDRESS_LINE_2,
LNDNG_SRC_TBL_CD.INSURED_CITY as INSURED_CITY,
LNDNG_SRC_TBL_CD.INSURED_STATE as INSURED_STATE,
LNDNG_SRC_TBL_CD.INSURED_ZIP_CODE as INSURED_ZIP_CODE,
LNDNG_SRC_TBL_CD.REVENUE as REVENUE,
LNDNG_SRC_TBL_CD.GROSS_PROFIT_NET_REVENUE as GROSS_PROFIT_NET_REVENUE,
LNDNG_SRC_TBL_CD.INDUSTRY as INDUSTRY,
LNDNG_SRC_TBL_CD.GICS_CODE as GICS_CODE,
LNDNG_SRC_TBL_CD.NETWORK_AND_INFORMATION_SECURITY as NETWORK_AND_INFORMATION_SECURITY,
LNDNG_SRC_TBL_CD.REGULATORY_FINES_AND_PENALTIES as REGULATORY_FINES_AND_PENALTIES,
LNDNG_SRC_TBL_CD.MULTIMEDIA_CONTENT as MULTIMEDIA_CONTENT,
LNDNG_SRC_TBL_CD.PCI_FINES_AND_ASSESSMENTS as PCI_FINES_AND_ASSESSMENTS,
LNDNG_SRC_TBL_CD.BREACH_RESPONSE as BREACH_RESPONSE,
LNDNG_SRC_TBL_CD.BREACH_RESPONSE_COSTS as BREACH_RESPONSE_COSTS,
LNDNG_SRC_TBL_CD.CRISIS_MANAGEMENT_AND_PUBLIC_RELATIONSHIP as CRISIS_MANAGEMENT_AND_PUBLIC_RELATIONSHIP,
LNDNG_SRC_TBL_CD.CYBER_EXTORTION as CYBER_EXTORTION,
LNDNG_SRC_TBL_CD.BUSINESS_INTERRUPTION_AND_EXTRA_EXPENSE as BUSINESS_INTERRUPTION_AND_EXTRA_EXPENSE,
LNDNG_SRC_TBL_CD.ENHANCED_WAITING_PERIOD as ENHANCED_WAITING_PERIOD,
LNDNG_SRC_TBL_CD.DIGITAL_ASSET_RESTORATION as DIGITAL_ASSET_RESTORATION,
LNDNG_SRC_TBL_CD.FUNDS_TRANSFER_FRAUD as FUNDS_TRANSFER_FRAUD,
LNDNG_SRC_TBL_CD.REPUTATION_REPAIR as REPUTATION_REPAIR,
LNDNG_SRC_TBL_CD.BI_PD_THIRD_PARTY as BI_PD_THIRD_PARTY,
LNDNG_SRC_TBL_CD.BI_PD_FIRST_PARTY as BI_PD_FIRST_PARTY,
LNDNG_SRC_TBL_CD.POLLUTION as POLLUTION,
LNDNG_SRC_TBL_CD.SYSTEMS_INTEGRITY_RESTORATION as SYSTEMS_INTEGRITY_RESTORATION,
LNDNG_SRC_TBL_CD.COMPUTER_REPLACEMENT as COMPUTER_REPLACEMENT,
LNDNG_SRC_TBL_CD.TECHNOLOGY_E_O as TECHNOLOGY_E_O,
LNDNG_SRC_TBL_CD.SERVICE_FRAUD as SERVICE_FRAUD,
LNDNG_SRC_TBL_CD.PROOF_OF_LOSS_PREPARATION_EXPENSES_SUBLIMIT as PROOF_OF_LOSS_PREPARATION_EXPENSES_SUBLIMIT,
LNDNG_SRC_TBL_CD.COURT_ATTENDANCE_SUBLIMIT as COURT_ATTENDANCE_SUBLIMIT,
LNDNG_SRC_TBL_CD.CRIMINAL_REWARD_SUBLIMIT as CRIMINAL_REWARD_SUBLIMIT,
LNDNG_SRC_TBL_CD.FUNDS_TRANSFER_LIABILITY_SUBLIMIT as FUNDS_TRANSFER_LIABILITY_SUBLIMIT,
LNDNG_SRC_TBL_CD.PHISHING_SUBLIMIT as PHISHING_SUBLIMIT,
LNDNG_SRC_TBL_CD.INVOICE_MANIPULATION_SUBLIMIT as INVOICE_MANIPULATION_SUBLIMIT,
LNDNG_SRC_TBL_CD.TCPA as TCPA,
LNDNG_SRC_TBL_CD.PRIMARY_INSURANCE as PRIMARY_INSURANCE,
LNDNG_SRC_TBL_CD.REPUTATIONAL_HARM_LOSS as REPUTATIONAL_HARM_LOSS,
LNDNG_SRC_TBL_CD.INSURANCE_PROGRAM as INSURANCE_PROGRAM,
LNDNG_SRC_TBL_CD.MARKET as MARKET,
LNDNG_SRC_TBL_CD.RETROACTIVE_DATE as RETROACTIVE_DATE,
LNDNG_SRC_TBL_CD.RETROACTIVE_SHORT_DATE as RETROACTIVE_SHORT_DATE,
LNDNG_SRC_TBL_CD.RENEWAL_OF_POLICY as RENEWAL_OF_POLICY,
LNDNG_SRC_TBL_CD.EXTENDED_REPORTING_PERIOD as EXTENDED_REPORTING_PERIOD,
LNDNG_SRC_TBL_CD.ERP_TAIL_DATE as ERP_TAIL_DATE,
LNDNG_SRC_TBL_CD.CURRENCY as CURRENCY,
LNDNG_SRC_TBL_CD.COUNTRY as COUNTRY,
LNDNG_SRC_TBL_CD.PRIMARY_CARRIER as PRIMARY_CARRIER,
LNDNG_SRC_TBL_CD.SCHEDULE_RATING_MODIFICATION as SCHEDULE_RATING_MODIFICATION,
LNDNG_SRC_TBL_CD.BINDER_EDIT as BINDER_EDIT,
LNDNG_SRC_TBL_CD.SRC_SYS_CD as SRC_SYS_CD,
LNDNG_SRC_TBL_CD.BUS_UNIT_CD as BUS_UNIT_CD,
LNDNG_SRC_TBL_CD.___REFRESH_TS_UTC as ___REFRESH_TS_UTC,

LNDNG_SRC_TBL_CD.CLASS_STAT_CD  -- aded as part of Alt Market 1.0 release
  
LNDNG_SRC_TBL_CD.MRKT_REGN      -- aded as part of Lenders 1.0 release

LNDNG_SRC_TBL_CD.POL_SYM_CM      --aded as part of Surety 1.0 release

FROM POC.MGA_PROGRAM.SOURCE_TBL_CAD LNDNG_SRC_TBL_CD
WHERE 1=1$$,
'INTERNAL_ID, EXTERNAL_ID, INSURED_NAME, POLICY_TYPE, POLICY_NUMBER, MODULE, FULL_POLICY, COALITION_POLICY_NUMBER, POLICY_EFFECTIVE_DATE, POLICY_EXPIRATION_DATE, TRANSACTION_EFFECTIVE_DATE, TRANSACTION_TYPE, TRANSACTION_DESCRIPTION, TRANSACTION_EFFECTIVE_BIND_DATE, AGGREGATE_TOTAL_LIMIT, TOTAL_LIMIT, ARCH_QUOTA_SHARE, ARCH_LIMIT_OF_LIABILITY, SIR_ATTACHMENT_POINT, TOTAL_BOUND_PREMIUM, ARCH_BOUND_PREMIUM, TOTAL_EARNED_PREMIUM, TOTAL_UNEARNED_PREMIUM, COALITION_COMMISSION, ARCH_COMMISSION_TO_COALITION, ARCH_NET_PREMIUM, TOTAL_TRIA, ARCH_TRIA, TRIA_ACCEPTED, BROKER, BROKER_ADDRESS, BROKER_CITY, BROKER_STATE, BROKER_ZIP_CODE, BROKER_COMMISSION, BROKER_REPORTED_LICENSE_NUMBER, REPORTED_LICENSE_ENTITY_INDIVIDUAL, COALITION_SECONDARY_REVIEW, CARRIER_REFERRAL, ACCOUNT_CURRENT_MONTH_END, CURRENT_MONTH_END, POLICY_STATUS_INDICATOR, COMMENTS, INSURED_ADDRESS_LINE_1, INSURED_ADDRESS_LINE_2, INSURED_CITY, INSURED_STATE, INSURED_ZIP_CODE, REVENUE, GROSS_PROFIT_NET_REVENUE, INDUSTRY, GICS_CODE, NETWORK_AND_INFORMATION_SECURITY, REGULATORY_FINES_AND_PENALTIES, MULTIMEDIA_CONTENT, PCI_FINES_AND_ASSESSMENTS, BREACH_RESPONSE, BREACH_RESPONSE_COSTS, CRISIS_MANAGEMENT_AND_PUBLIC_RELATIONSHIP, CYBER_EXTORTION, BUSINESS_INTERRUPTION_AND_EXTRA_EXPENSE, ENHANCED_WAITING_PERIOD, DIGITAL_ASSET_RESTORATION, FUNDS_TRANSFER_FRAUD, REPUTATION_REPAIR, BI_PD_THIRD_PARTY, BI_PD_FIRST_PARTY, POLLUTION, SYSTEMS_INTEGRITY_RESTORATION, COMPUTER_REPLACEMENT, TECHNOLOGY_E_O, SERVICE_FRAUD, PROOF_OF_LOSS_PREPARATION_EXPENSES_SUBLIMIT, COURT_ATTENDANCE_SUBLIMIT, CRIMINAL_REWARD_SUBLIMIT, FUNDS_TRANSFER_LIABILITY_SUBLIMIT, PHISHING_SUBLIMIT, INVOICE_MANIPULATION_SUBLIMIT, TCPA, PRIMARY_INSURANCE, REPUTATIONAL_HARM_LOSS, INSURANCE_PROGRAM, MARKET, RETROACTIVE_DATE, RETROACTIVE_SHORT_DATE, RENEWAL_OF_POLICY, EXTENDED_REPORTING_PERIOD, ERP_TAIL_DATE, CURRENCY, COUNTRY, PRIMARY_CARRIER, SCHEDULE_RATING_MODIFICATION, BINDER_EDIT, SRC_SYS_CD, BUS_UNIT_CD, ___REFRESH_TS_UTC'
,	'3',	'SOURCE_TBL_CAD',	'LNDNG_SRC_TBL_CD',	'POC.MGA_PROGRAM.SOURCE_TBL_CAD',	0,	'POC.Staging.MGA_PROGRAM_SOURCE_TBL_CAD_STREAM'	,'POC.Staging.MGA_PROGRAM_SOURCE_TBL_CAD_HIST');
